<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tool</title>

    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ› ï¸</text></svg>">
    
    <style>
        body { font-family: -apple-system, sans-serif; margin: 0; padding: 40px 20px; background: #f0f2f5; display: flex; justify-content: center; }
        .container { width: 100%; max-width: 600px; text-align: center; }
        
        h1 { color: #1c1e21; margin-bottom: 30px; font-size: 24px; }
        
        .nav-grid { display: grid; grid-template-columns: 1fr; gap: 15px; }
        
        /* å°èˆªæŒ‰éˆ•æ¨£å¼ */
        .nav-card {
            background: #ffffff;
            padding: 20px;
            border-radius: 12px;
            text-decoration: none;
            color: #4b4f56;
            font-weight: bold;
            font-size: 18px;
            border: 1px solid #ddd;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: space-between; /* è®“æ–‡å­—å’Œåœ–æ¨™åˆ†é–‹ */
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .nav-card:hover {
            background: #ffc4ed;
            color: #ffffff;
            border-color: #ffb5e9;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,123,255,0.2);
        }

        .icon { font-size: 22px; }
        .name-tag { display: flex; align-items: center; }
        .file-name { font-size: 12px; opacity: 0.6; margin-left: 10px; font-weight: normal; }
        
        footer { margin-top: 40px; color: #888; font-size: 12px; }

        /* è®€å–å‹•ç•« */
        .loading { color: #888; font-style: italic; }
    </style>
</head>
<body>

<div class="container">

    <div class="nav-grid" id="navGrid">
        <div class="loading">æ­£åœ¨é€£ç·šè‡³è©¦ç®—è¡¨è¼‰å…¥é¸å–®...</div>
    </div>

    <footer>
        <div class="footer">Â© 2026 02 02</div>
    </footer>
</div>

<script>
    // 1. è¨­å®šä½ çš„è©¦ç®—è¡¨ ID
    const spreadsheetId = "1derDn2oXg3-NbMNoVtLwvye466dophZVOgrDID-rlbg";
    // 2. è¨­å®šå°ˆé–€å­˜æ”¾ã€Œé¸å–®æ¸…å–®ã€çš„å·¥ä½œè¡¨åç¨±ï¼ˆä¾‹å¦‚å« Indexï¼‰
    const indexSheetName = "Index"; 

    async function loadNav() {
        const navGrid = document.getElementById('navGrid');
        const sheetURL = `https://docs.google.com/spreadsheets/d/${spreadsheetId}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent(indexSheetName)}`;

        try {
            const res = await fetch(sheetURL);
            const text = await res.text();
            
            // è§£æ CSVï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€å€‹ç¶²é æŒ‰éˆ•
            // å»ºè­°è©¦ç®—è¡¨æ ¼å¼ï¼šç¬¬ä¸€æ¬„æ”¾é¡¯ç¤ºåç¨±(å¦‚: æœå°‹å·¥å…·)ï¼Œç¬¬äºŒæ¬„æ”¾æª”å(å¦‚: Search)
            const lines = text.split('\n')
                              .map(l => l.trim().replace(/"/g, ''))
                              .filter(Boolean);

            navGrid.innerHTML = ''; // æ¸…é™¤ loading

            lines.forEach(line => {
                const parts = line.split(',');
                const displayName = parts[0]; // é¡¯ç¤ºåœ¨æŒ‰éˆ•ä¸Šçš„æ–‡å­—
                const fileName = parts[1] || parts[0]; // å°æ‡‰çš„ HTML æª”åï¼Œæ²’å¡«å°±ç”¨ç¬¬ä¸€å€‹
                const icon = parts[2] || ""; // ç¬¬ä¸‰æ¬„æ”¾åœ–æ¨™ï¼Œæ²’å¡«å°±ç”¨é€£çµåœ–ç¤º

                const a = document.createElement('a');
                a.href = `${fileName}.html`;
                a.className = 'nav-card';
                a.innerHTML = `
                    <div class="name-tag">
                        <span class="icon">${icon}</span>
                        <span>${displayName}</span>
                    </div>
                    <span>âœ</span>
                `;
                navGrid.appendChild(a);
            });

        } catch (e) {
            console.error(e);
            navGrid.innerHTML = '<div style="color:red;">è¼‰å…¥æ¸…å–®å¤±æ•—ï¼Œè«‹æª¢æŸ¥å·¥ä½œè¡¨ [Index] æ˜¯å¦å­˜åœ¨ä¸”å·²é–‹å•Ÿå…±ç”¨ã€‚</div>';
        }
    }

    loadNav();
</script>

</body>
</html>